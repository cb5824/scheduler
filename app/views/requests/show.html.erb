<%= link_to 'Back to Requests', requests_path %>

<h1><%= @request.title %></h1>
<ul>
  <li>Contractor: <%= @request.contractor %></li>
  <li>Description: <%= @request.description %></li>
  <li>Mon: <%= @request.monday %></li>
  <li>Tues: <%= @request.tuesday %></li>
  <li>Wed: <%= @request.wednesday %></li>
  <li>Thurs: <%= @request.thursday %></li>
  <li>Fri: <%= @request.friday %></li>
  <li>Sat: <%= @request.saturday %></li>
  <li>Sun: <%= @request.sunday %></li>
  <li>Night Work?: <%= @request.night_work %></li>
  <li>Start Time: <%= @request.start_time %></li>
  <li>End Time: <%= @request.end_time %></li>
  <li>TAW: <%= @request.taw %></li>
  <li>Form B: <%= @request.form_b %></li>
  <li>form C: <%= @request.form_c %></li>
  <li>Track and Time: <%= @request.track_and_time %></li>
  <li>Created: <%= @request.created_at %></li>
  <li>Last Updated: <%= @request.updated_at %></li>
</ul>
<br>

<% @request.attachments.each do |attachment| %>
<div class="level">
  <%= link_to attachment.filename, rails_blob_path(attachment, only_path: true) %>
</div>
<% end %>

<h3>Current Status: <%= @request.status.upcase %>
  <br>
  <%= link_to 'Edit', edit_request_path(@request) %>
  <% if @user.role == "admin" %>
  <%= button_to 'Approve', request_approve_path(@request), method: :put, data: { confirm: 'This request will be approved. Proceed?' }, params: {new_status: 'approved'} %>
  <%= button_to 'Reject', request_approve_path(@request), method: :put, data: { confirm: 'This request will be rejected. Proceed?' }, params: {new_status: 'rejected'} %>

  <h1>Change Log</h1>

  <% @entries.each do |entry| %>
  <li>
    <div class="log_block_container">
      <div class="log_header">
        User: <%= User.where(id: entry.user_id)[0].name %> at <%= entry.created_at %>
      </div>
      <div class="log_block <% if entry[:new_values]["status"] %><%= entry[:new_values]["status"] %><% end %>">
        <div class="old_value_block">
          Previous Values:
          <ul>
          <% entry[:old_values].each do |key, value| %>
          <li>
          <%= key %> => <%= value %>
          </li>
          <% end %>
          <ul>
        </div>
        <div class="new_value_block">
          New Values:
          <ul>
          <% entry[:new_values].each do |key, value| %>
          <li>
          <%= key %> => <%= value %>
          </li>
          <% end %>
          <ul>
        </div>
        <div class="comments_block">
          Comments:
          <ul>
            <li><%= entry[:comments] %><li>
          <ul>
        </div>
    </div>
  </div>
  </li>

  <% end %>
<% end %>
